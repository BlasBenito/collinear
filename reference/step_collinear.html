<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Tidymodels recipe step for multicollinearity filtering — step_collinear • collinear</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Tidymodels recipe step for multicollinearity filtering — step_collinear"><meta name="description" content="Adds a step to a recipe created by recipes::recipe()]+ to apply multicollinearity filtering via collinear().
This function requires the recipes package to be installed.
Unlike collinear(), this wrapper does not perform target encoding, and the default value for the argument quiet is TRUE."><meta property="og:description" content="Adds a step to a recipe created by recipes::recipe()]+ to apply multicollinearity filtering via collinear().
This function requires the recipes package to be installed.
Unlike collinear(), this wrapper does not perform target encoding, and the default value for the argument quiet is TRUE."><meta property="og:image" content="https://blasbenito.github.io/collinear/logo.png"><link rel="stylesheet" href="extra.css"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">collinear</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/unified_correlation_framework.html">Unified Correlation Framework</a></li>
    <li><a class="dropdown-item" href="../articles/intelligent_predictor_ranking.html">Intelligent Predictor Ranking</a></li>
    <li><a class="dropdown-item" href="../articles/target_encoding.html">Target Encoding</a></li>
    <li><a class="dropdown-item" href="../articles/adaptive_filtering_thresholds.html">Adaptive Filtering Thresholds</a></li>
    <li><a class="dropdown-item" href="../articles/dual_filtering_strategy.html">Dual Filtering Strategy</a></li>
    <li><a class="dropdown-item" href="../articles/collinear_in_the_wild.html">collinear In The Wild</a></li>
    <li><a class="dropdown-item" href="../articles/download_history.html">Download history</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-blog-posts" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Blog Posts</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-blog-posts"><li><a class="external-link dropdown-item" href="https://www.blasbenito.com/post/multicollinearity-model-interpretability/">Multicollinearity Hinders Model Interpretability</a></li>
    <li><a class="external-link dropdown-item" href="https://www.blasbenito.com/post/variance-inflation-factor/">Everything About Variance Inflation Factors</a></li>
    <li><a class="external-link dropdown-item" href="https://www.blasbenito.com/post/target-encoding/">Mapping Categorical Predictors to Numeric</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/blasbenito/collinear/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Tidymodels recipe step for multicollinearity filtering</h1>
      <small class="dont-index">Source: <a href="https://github.com/blasbenito/collinear/blob/main/R/step_collinear.R" class="external-link"><code>R/step_collinear.R</code></a></small>
      <div class="d-none name"><code>step_collinear.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Adds a step to a recipe created by <code>recipes::recipe()]+</code> to apply multicollinearity filtering via <code><a href="collinear.html">collinear()</a></code>.</p>
<p>This function requires the <code>recipes</code> package to be installed.</p>
<p>Unlike <code><a href="collinear.html">collinear()</a></code>, this wrapper does not perform target encoding, and the default value for the argument <code>quiet</code> is <code>TRUE</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">step_collinear</span><span class="op">(</span></span>
<span>  <span class="va">recipe</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  role <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  trained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  selected <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  skip <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  keep_original_cols <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  id <span class="op">=</span> <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/rand_id.html" class="external-link">rand_id</a></span><span class="op">(</span><span class="st">"collinear"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'step_collinear'</span></span>
<span><span class="fu"><a href="https://recipes.tidymodels.org/reference/prep.html" class="external-link">prep</a></span><span class="op">(</span>x <span class="op">=</span> <span class="cn">NULL</span>, training <span class="op">=</span> <span class="cn">NULL</span>, info <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'step_collinear'</span></span>
<span><span class="fu"><a href="https://recipes.tidymodels.org/reference/bake.html" class="external-link">bake</a></span><span class="op">(</span>object <span class="op">=</span> <span class="cn">NULL</span>, new_data <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-recipe">recipe<a class="anchor" aria-label="anchor" href="#arg-recipe"></a></dt>
<dd><p>(required, recipe) A recipe object to which this step will be added.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>(optional) Additional arguments (currently ignored).</p></dd>


<dt id="arg-role">role<a class="anchor" aria-label="anchor" href="#arg-role"></a></dt>
<dd><p>(optional, character) Not used by this step since no new variables are created. Default: NA</p></dd>


<dt id="arg-trained">trained<a class="anchor" aria-label="anchor" href="#arg-trained"></a></dt>
<dd><p>(optional, logical) Indicates if the step has been trained. Default: FALSE</p></dd>


<dt id="arg-options">options<a class="anchor" aria-label="anchor" href="#arg-options"></a></dt>
<dd><p>(optional, list) Named list of arguments passed to <code><a href="collinear.html">collinear()</a></code>. Common options include:</p><ul><li><p><code>max_cor</code>: Maximum correlation threshold. If NULL (default), automatically set based on median correlation of predictors.</p></li>
<li><p><code>max_vif</code>: Maximum VIF threshold. If NULL (default), automatically set to match the auto-computed max_cor.</p></li>
<li><p><code>preference_order</code>: Vector of predictor names in priority order.</p></li>
<li><p><code>f</code>: Function to compute preference order (default: <code>f_auto</code>)</p></li>
<li><p><code>quiet</code>: Suppress messages (default: TRUE)</p></li>
</ul><p>Note: <code>encoding_method</code> is not supported in this step. The automatic threshold selection adapts to each dataset's correlation structure.</p></dd>


<dt id="arg-selected">selected<a class="anchor" aria-label="anchor" href="#arg-selected"></a></dt>
<dd><p>(character vector) Predictors retained after filtering. Populated during training and used during baking. Default: NULL</p></dd>


<dt id="arg-skip">skip<a class="anchor" aria-label="anchor" href="#arg-skip"></a></dt>
<dd><p>(optional, logical) Trigger to skip this step when baking. Default: FALSE.</p></dd>


<dt id="arg-keep-original-cols">keep_original_cols<a class="anchor" aria-label="anchor" href="#arg-keep-original-cols"></a></dt>
<dd><p>(optional, logical) Whether to keep original columns. Default: FALSE.</p></dd>


<dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>(optional, character) Unique identifier for this step.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>(required, step_collinear object) The step to be trained. Default: NULL</p></dd>


<dt id="arg-training">training<a class="anchor" aria-label="anchor" href="#arg-training"></a></dt>
<dd><p>(required, data.frame) The training dataset used to estimate quantities.</p></dd>


<dt id="arg-info">info<a class="anchor" aria-label="anchor" href="#arg-info"></a></dt>
<dd><p>(optional, data.frame) Preprocessed information about variables in <code>training</code>. Default: NULL</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>(required, <code>step_collinear</code> object) The trained step. Default: NULL</p></dd>


<dt id="arg-new-data">new_data<a class="anchor" aria-label="anchor" href="#arg-new-data"></a></dt>
<dd><p>(required, data.frame) New data to apply the step to. Default: NULL</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Updated recipe with new step.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other multicollinearity_filtering:
<code><a href="collinear.html">collinear()</a></code>,
<code><a href="collinear_select.html">collinear_select()</a></code>,
<code><a href="cor_select.html">cor_select()</a></code>,
<code><a href="vif_select.html">vif_select()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"recipes"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"parsnip"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"workflows"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vi_smol</span>,</span></span>
<span class="r-in"><span>  <span class="va">vi_predictors_numeric</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># model formula</span></span></span>
<span class="r-in"><span><span class="va">vi_formula</span> <span class="op">&lt;-</span> <span class="fu">collinear</span><span class="fu">::</span><span class="fu"><a href="model_formula.html">model_formula</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi_smol</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"vi_numeric"</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors_numeric</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># recipe</span></span></span>
<span class="r-in"><span><span class="va">vi_recipe</span> <span class="op">&lt;-</span> <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/recipe.html" class="external-link">recipe</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">vi_formula</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">vi_smol</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co">#multicollinearity filtering</span></span></span>
<span class="r-in"><span>  <span class="fu">collinear</span><span class="fu">::</span><span class="fu">step_collinear</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    options <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      max_cor <span class="op">=</span> <span class="fl">0.7</span>,</span></span>
<span class="r-in"><span>      max_vif <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>      f <span class="op">=</span> <span class="fu">collinear</span><span class="fu">::</span><span class="va"><a href="f_numeric_glm.html">f_numeric_glm</a></span></span></span>
<span class="r-in"><span>      <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="co">#normalization</span></span></span>
<span class="r-in"><span>  <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/step_normalize.html" class="external-link">step_normalize</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">recipes</span><span class="fu">::</span><span class="fu"><a href="https://recipes.tidymodels.org/reference/has_role.html" class="external-link">all_predictors</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define linear regression model</span></span></span>
<span class="r-in"><span><span class="va">vi_model</span> <span class="op">&lt;-</span> <span class="fu">parsnip</span><span class="fu">::</span><span class="fu">linear_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">parsnip</span><span class="fu">::</span><span class="fu">set_engine</span><span class="op">(</span><span class="st">"lm"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># create and fit workflow</span></span></span>
<span class="r-in"><span><span class="va">vi_workflow</span> <span class="op">&lt;-</span> <span class="fu">workflows</span><span class="fu">::</span><span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu">add_recipe</span><span class="op">(</span><span class="va">vi_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu">add_model</span><span class="op">(</span><span class="va">vi_model</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu">workflows</span><span class="fu">::</span><span class="fu">fit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">vi_smol</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">vi_workflow</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://blasbenito.com" class="external-link">Blas M. Benito</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

