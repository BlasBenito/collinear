<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Correlation matrix of numeric and character variables — cor_matrix • collinear</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Correlation matrix of numeric and character variables — cor_matrix"><meta name="description" content="Returns a correlation matrix between all pairs of predictors in a training dataset. Non-numeric predictors are transformed into numeric via target encoding, using the 'response' variable as reference."><meta property="og:description" content="Returns a correlation matrix between all pairs of predictors in a training dataset. Non-numeric predictors are transformed into numeric via target encoding, using the 'response' variable as reference."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">collinear</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Correlation matrix of numeric and character variables</h1>

      <div class="d-none name"><code>cor_matrix.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Returns a correlation matrix between all pairs of predictors in a training dataset. Non-numeric predictors are transformed into numeric via target encoding, using the 'response' variable as reference.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cor_matrix</span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  encoding_method <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>(required; data frame) A data frame with numeric and/or character predictors, and optionally, a response variable. Default: NULL.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>(recommended, character string) Name of a numeric response variable. Character response variables are ignored. Please, see 'Details' to better understand how providing this argument or not leads to different results when there are character variables in 'predictors'. Default: NULL.</p></dd>


<dt id="arg-predictors">predictors<a class="anchor" aria-label="anchor" href="#arg-predictors"></a></dt>
<dd><p>(optional; character vector) character vector with predictor names in 'df'. If omitted, all columns of 'df' are used as predictors. Default:'NULL'</p></dd>


<dt id="arg-cor-method">cor_method<a class="anchor" aria-label="anchor" href="#arg-cor-method"></a></dt>
<dd><p>(optional; character string) Method used to compute pairwise correlations. Accepted methods are "pearson" (with a recommended minimum of 30 rows in 'df') or "spearman" (with a recommended minimum of 10 rows in 'df'). Default: "pearson".</p></dd>


<dt id="arg-encoding-method">encoding_method<a class="anchor" aria-label="anchor" href="#arg-encoding-method"></a></dt>
<dd><p>(optional; character string). Name of the target encoding method to convert character and factor predictors to numeric. One of "mean", "rank", "loo", "rnorm" (see <code><a href="target_encoding_lab.html">target_encoding_lab()</a></code> for further details). Default: "mean"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>correlation matrix</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function attempts to handle correlations between pairs of variables that can be of different types:</p><ul><li><p>numeric vs. numeric: computed with stats::cor() with the methods "pearson" or "spearman".</p></li>
<li><p>numeric vs. character, two alternatives leading to different results:</p><ul><li><p>'response' is provided: the character variable is target-encoded as numeric using the values of the response as reference, and then its correlation with the numeric variable is computed with stats::cor(). This option generates a response-specific result suitable for training statistical and machine-learning models</p></li>
<li><p>'response' is NULL (or the name of a non-numeric column): the character variable is target-encoded as numeric using the values of the numeric predictor (instead of the response) as reference, and then their correlation is computed with stats::cor(). This option leads to a response-agnostic result suitable for clustering problems.</p></li>
</ul></li>
<li><p>character vs. character, two alternatives leading to different results:</p><ul><li><p>'response' is provided: the character variables are target-encoded as numeric using the values of the response as reference, and then their correlation is computed with stats::cor().</p></li>
<li><p>response' is NULL (or the name of a non-numeric column): the association between the character variables is computed using Cramer's V. This option might be problematic, because R-squared values and Cramer's V, even when having the same range between 0 and 1, are not fully comparable.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Blas M. Benito</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  <span class="va">vi_predictors</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#subset to limit example run time</span></span></span>
<span class="r-in"><span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="va">vi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">vi_predictors</span> <span class="op">&lt;-</span> <span class="va">vi_predictors</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#convert correlation data frame to matrix</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="cor_df.html">cor_df</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">cor_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">df</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#show first three columns and rows</span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    koppen_zone koppen_description koppen_group soil_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_zone              1.000              0.997        0.991     0.335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_description       0.997              1.000        0.871     0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_group             0.991              0.871        1.000     0.577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil_type                0.335              0.365        0.577     1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> topo_slope               0.397              0.365        0.290     0.359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    topo_slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_zone             0.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_description      0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_group            0.290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil_type               0.359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> topo_slope              1.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#generate correlation matrix directly</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">cor_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    koppen_zone koppen_description koppen_group soil_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_zone              1.000              0.997        0.991     0.335</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_description       0.997              1.000        0.871     0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_group             0.991              0.871        1.000     0.577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil_type                0.335              0.365        0.577     1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> topo_slope               0.397              0.365        0.290     0.359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    topo_slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_zone             0.397</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_description      0.365</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_group            0.290</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil_type               0.359</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> topo_slope              1.000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#with response (much faster)</span></span></span>
<span class="r-in"><span><span class="co">#different solution than previous one</span></span></span>
<span class="r-in"><span><span class="co">#because target encoding is done against the response</span></span></span>
<span class="r-in"><span><span class="co">#rather than against the other numeric in the pair</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">cor_matrix</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"vi_mean"</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">m</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    koppen_zone koppen_group koppen_description soil_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_zone              1.000        0.937              0.991     0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_group             0.937        1.000              0.933     0.747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_description       0.991        0.933              1.000     0.771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil_type                0.775        0.747              0.771     1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> topo_slope               0.164        0.175              0.148     0.139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    topo_slope</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_zone             0.164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_group            0.175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> koppen_description      0.148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> soil_type               0.139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> topo_slope              1.000</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

