<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Automated multicollinearity reduction via pairwise correlation — cor_select • collinear</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Automated multicollinearity reduction via pairwise correlation — cor_select"><meta name="description" content='Applies a recursive forward selection algorithm algorithm to select predictors with a bivariate correlation with any other predictor lower than a threshold defined by the argument max_cor.
If the argument response is provided, all non-numeric variables in predictors are transformed into numeric using target encoding (see target_encoding_lab()). Otherwise, non-numeric variables are ignored.
The argument preference_order allows defining a preference selection order to preserve (when possible) variables that might be interesting or even required for a given analysis. If NULL, predictors are ordered from lower to higher sum of their absolute pairwise correlation with the other predictors.
For example, if predictors is c("a", "b", "c") and preference_order is c("a", "b"), there are two possibilities:
If the correlation between "a" and "b" is below max_cor, both variables are selected.
If their correlation is equal or above max_cor, then "a" is selected, no matter its correlation with "c",


If preference_order is not provided, then the predictors are ranked by their variance inflation factor as computed by vif_df().'><meta property="og:description" content='Applies a recursive forward selection algorithm algorithm to select predictors with a bivariate correlation with any other predictor lower than a threshold defined by the argument max_cor.
If the argument response is provided, all non-numeric variables in predictors are transformed into numeric using target encoding (see target_encoding_lab()). Otherwise, non-numeric variables are ignored.
The argument preference_order allows defining a preference selection order to preserve (when possible) variables that might be interesting or even required for a given analysis. If NULL, predictors are ordered from lower to higher sum of their absolute pairwise correlation with the other predictors.
For example, if predictors is c("a", "b", "c") and preference_order is c("a", "b"), there are two possibilities:
If the correlation between "a" and "b" is below max_cor, both variables are selected.
If their correlation is equal or above max_cor, then "a" is selected, no matter its correlation with "c",


If preference_order is not provided, then the predictors are ranked by their variance inflation factor as computed by vif_df().'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">collinear</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Automated multicollinearity reduction via pairwise correlation</h1>

      <div class="d-none name"><code>cor_select.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applies a recursive forward selection algorithm algorithm to select predictors with a bivariate correlation with any other predictor lower than a threshold defined by the argument <code>max_cor</code>.</p>
<p>If the argument <code>response</code> is provided, all non-numeric variables in <code>predictors</code> are transformed into numeric using target encoding (see <code><a href="target_encoding_lab.html">target_encoding_lab()</a></code>). Otherwise, non-numeric variables are ignored.</p>
<p>The argument <code>preference_order</code> allows defining a preference selection order to preserve (when possible) variables that might be interesting or even required for a given analysis. If NULL, predictors are ordered from lower to higher sum of their absolute pairwise correlation with the other predictors.</p>
<p>For example, if <code>predictors</code> is <code>c("a", "b", "c")</code> and <code>preference_order</code> is <code>c("a", "b")</code>, there are two possibilities:</p><ul><li><p>If the correlation between <code>"a"</code> and <code>"b"</code> is below <code>max_cor</code>, both variables are selected.</p></li>
<li><p>If their correlation is equal or above <code>max_cor</code>, then <code>"a"</code> is selected, no matter its correlation with <code>"c"</code>,</p></li>
</ul><p>If <code>preference_order</code> is not provided, then the predictors are ranked by their variance inflation factor as computed by <code><a href="vif_df.html">vif_df()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cor_select</span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  response <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  predictors <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  preference_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cor_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  max_cor <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  encoding_method <span class="op">=</span> <span class="st">"mean"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>(required; data frame) A data frame with numeric and/or character predictors predictors, and optionally, a response variable. Default: NULL.</p></dd>


<dt id="arg-response">response<a class="anchor" aria-label="anchor" href="#arg-response"></a></dt>
<dd><p>(recommended, character string) Name of a numeric response variable. Character response variables are ignored. Please, see 'Details' to better understand how providing this argument or not leads to different results when there are character variables in 'predictors'. Default: NULL.</p></dd>


<dt id="arg-predictors">predictors<a class="anchor" aria-label="anchor" href="#arg-predictors"></a></dt>
<dd><p>(optional; character vector) Character vector with predictor names in 'df'. If omitted, all columns of 'df' are used as predictors. Default:'NULL'</p></dd>


<dt id="arg-preference-order">preference_order<a class="anchor" aria-label="anchor" href="#arg-preference-order"></a></dt>
<dd><p>(optional; character vector) vector with column names in 'predictors' in the desired preference order, or result of the function <code><a href="preference_order.html">preference_order()</a></code>. Allows defining a priority order for selecting predictors, which can be particularly useful when some predictors are more critical for the analysis than others. Default: NULL (predictors ordered from lower to higher sum of absolute correlation with the other predictors).</p></dd>


<dt id="arg-cor-method">cor_method<a class="anchor" aria-label="anchor" href="#arg-cor-method"></a></dt>
<dd><p>(optional; character string) Method used to compute pairwise correlations. Accepted methods are "pearson" (with a recommended minimum of 30 rows in 'df') or "spearman" (with a recommended minimum of 10 rows in 'df'). Default: "pearson".</p></dd>


<dt id="arg-max-cor">max_cor<a class="anchor" aria-label="anchor" href="#arg-max-cor"></a></dt>
<dd><p>(optional; numeric) Maximum correlation allowed between any pair of predictors. Higher values return larger number of predictors with higher multicollinearity. Default: 0.75</p></dd>


<dt id="arg-encoding-method">encoding_method<a class="anchor" aria-label="anchor" href="#arg-encoding-method"></a></dt>
<dd><p>(optional; character string). Name of the target encoding method to convert character and factor predictors to numeric. One of "mean", "rank", "loo", "rnorm" (see <code><a href="target_encoding_lab.html">target_encoding_lab()</a></code> for further details). Default: "mean"</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Character vector with the names of the selected predictors.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Blas M. Benito</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  <span class="va">vi_predictors</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#subset to limit example run time</span></span></span>
<span class="r-in"><span><span class="va">vi</span> <span class="op">&lt;-</span> <span class="va">vi</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">vi_predictors</span> <span class="op">&lt;-</span> <span class="va">vi_predictors</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#without response</span></span></span>
<span class="r-in"><span><span class="co">#without preference_order</span></span></span>
<span class="r-in"><span><span class="co">#permissive max_cor</span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span> <span class="op">&lt;-</span> <span class="fu">cor_select</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span>,</span></span>
<span class="r-in"><span>  max_cor <span class="op">=</span> <span class="fl">0.8</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "topo_elevation" "topo_slope"     "topo_diversity" "soil_type"     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "swi_min"        "swi_max"       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#without response</span></span></span>
<span class="r-in"><span><span class="co">#without preference_order</span></span></span>
<span class="r-in"><span><span class="co">#restrictive max_cor</span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span> <span class="op">&lt;-</span> <span class="fu">cor_select</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span>,</span></span>
<span class="r-in"><span>  max_cor <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "topo_elevation" "topo_slope"     "soil_type"     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#with response</span></span></span>
<span class="r-in"><span><span class="co">#without preference_order</span></span></span>
<span class="r-in"><span><span class="co">#restrictive max_cor</span></span></span>
<span class="r-in"><span><span class="co">#slightly different solution than previous one</span></span></span>
<span class="r-in"><span><span class="co">#because here target encoding is done against the response</span></span></span>
<span class="r-in"><span><span class="co">#while before was done pairwise against each numeric predictor</span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span> <span class="op">&lt;-</span> <span class="fu">cor_select</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"vi_mean"</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span>,</span></span>
<span class="r-in"><span>  max_cor <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "topo_elevation" "topo_slope"     "swi_min"        "soil_type"     </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#with response</span></span></span>
<span class="r-in"><span><span class="co">#with user-defined preference_order</span></span></span>
<span class="r-in"><span><span class="co">#restrictive max_cor</span></span></span>
<span class="r-in"><span><span class="co">#numerics and categorical variables in output</span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span> <span class="op">&lt;-</span> <span class="fu">cor_select</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"vi_mean"</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span>,</span></span>
<span class="r-in"><span>  preference_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"soil_type"</span>, <span class="co">#categorical variable</span></span></span>
<span class="r-in"><span>    <span class="st">"soil_temperature_mean"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"swi_mean"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"rainfall_mean"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"evapotranspiration_mean"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  max_cor <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "soil_type"      "topo_elevation" "topo_slope"     "swi_min"       </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#with response</span></span></span>
<span class="r-in"><span><span class="co">#with automated preference_order</span></span></span>
<span class="r-in"><span><span class="co">#restrictive max_cor and max_vif</span></span></span>
<span class="r-in"><span><span class="co">#numerics and categorical variables in output</span></span></span>
<span class="r-in"><span><span class="va">preference.order</span> <span class="op">&lt;-</span> <span class="fu"><a href="preference_order.html">preference_order</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"vi_mean"</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span>,</span></span>
<span class="r-in"><span>  f <span class="op">=</span> <span class="va">f_rsquared</span> <span class="co">#cor(response, predictor)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">preference.order</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            predictor preference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1        koppen_zone  0.8137065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 koppen_description  0.7984011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3           swi_mean  0.7433342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4       koppen_group  0.7150807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5          soil_type  0.6465576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6            swi_max  0.5933516</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span> <span class="op">&lt;-</span> <span class="fu">cor_select</span><span class="op">(</span></span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="va">vi</span>,</span></span>
<span class="r-in"><span>  response <span class="op">=</span> <span class="st">"vi_mean"</span>,</span></span>
<span class="r-in"><span>  predictors <span class="op">=</span> <span class="va">vi_predictors</span>,</span></span>
<span class="r-in"><span>  preference_order <span class="op">=</span> <span class="va">preference.order</span>,</span></span>
<span class="r-in"><span>  max_cor <span class="op">=</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">selected.predictors</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "koppen_zone"    "topo_diversity" "topo_elevation"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Blas M. Benito.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

